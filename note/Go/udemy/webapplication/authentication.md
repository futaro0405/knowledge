# Auth Packages Introduction
このビデオでは、認証に使用するライブラリについて説明します。

1. 現在の状況：
    - アプリにはユーザー認証がありません。
    - URLを知っている人なら誰でもすべてのノートを見ることができます。
    - 認証のテスト用に、多数のノートがアプリに追加されています。
2. 使用する最初のライブラリ：bcrypt
    - bcryptは適応型ハッシュアルゴリズムです。
    - ユーザーパスワードはこのアルゴリズムでハッシュ化され、データベースに保存されます。
    - ユーザーがサインインする際、新しいパスワードが再度ハッシュ化され、データベースに保存されているハッシュ化されたパスワードと比較されます。
3. 使用する2つ目のパッケージ：sessions
    - ユーザーのセッション情報を保存するために使用されます。
    - sessionsパッケージは多くの種類のバックエンドをサポートしています：
        - Redis
        - Memcached
        - MongoDB
        - PostgreSQL など

これらのライブラリを使用することで、アプリケーションにセキュアな認証システムを実装し、ユーザーごとのデータ保護を実現することができます。

# Login and Signup Pages

![[Pasted image 20241020105318.png]]

1. ユーザー認証の実装前に、サインアップとログイン用の簡単なフォームを作成します。
2. サインアップページの構成：
    - ユーザーのメールアドレス
    - パスワード
    - パスワード確認
3. ログインフォームの構成：
    - ユーザーのメールアドレス
    - パスワード

![[Pasted image 20241020105437.png]]

1. テンプレートの名前変更：
    - 「template/views」を「template/home」に変更
    - すべての参照を更新

![[Pasted image 20241020105703.png]]

1. サインアップフォームの新規テンプレート作成：
    - index.htmlから基本構造をコピー
    - テンプレート名を変更
    - 見出しを「Sign Up」に変更
    - フォームのアクションを「/signup」に設定
    - 入力フィールドを適切に設定（email, password, confirm password）

![[Pasted image 20241020121633.png]]

1. ログインページのテンプレート作成：
    - サインアップページからコードをコピー
    - 見出しを「Login」に変更
    - フォームのアクションを「/login」に設定
    - パスワード確認フィールドを削除

![[Pasted image 20241020121704.png]]

1. main.goにルートを追加：
    - "/login" → LoginPage
    - "/signup" → SignupPage

![[Pasted image 20241020121820.png]]

1. 新しいコントローラ（SessionController）の作成：
    - LoginPageハンドラとSignupPageハンドラを実装
    - これらのハンドラは単にHTMLページをレンダリング

![[Pasted image 20241020122058.png]]

1. アプリケーションのメインページにログインとサインアップボタンを追加
2. サーバーを再起動し、ブラウザでテスト：
    - localhost:8080にアクセス
    - ログインとサインアップボタンが表示されることを確認
    - 各ボタンをクリックし、対応するフォームが正しくレンダリングされることを確認

これらの手順により、基本的なログインとサインアップのユーザーインターフェースが実装されました。次のステップでは、これらのフォームに機能を追加し、実際の認証プロセスを実装することになります。

# User model and Signup functionality

![[Pasted image 20241020124537.png]]

1. まず、パスワードハッシュ化に役立つbcryptパッケージをインストールします。
2. 次に、ユーザーセッション管理のためのsessionsパッケージをインストールします。

![[Pasted image 20241020124712.png]]

1. ヘルパー関数を含む新しいディレクトリ「helpers」を作成します。
2. 「password_hashing.go」ファイルを作成し、パスワードのハッシュ化と照合のための2つの関数を実装します：
    - hashPassword: パスワードをハッシュ化
    - checkPasswordHash: パスワードとハッシュを比較

![[Pasted image 20241020124843.png]]

1. 「session.go」ファイルを作成し、セッション管理のユーティリティ関数を実装します：
    - SessionSet: ユーザーIDをセッションに保存
    - SessionGet: セッションからユーザーIDを取得
    - SessionClear: セッションからユーザーIDをクリア

![[Pasted image 20241020124955.png]]

1. 「models/user.go」にユーザーモデルを作成し、構造体を定義します。

![[Pasted image 20241020125125.png]]

1. セッション管理の関数を実装します。

![[Pasted image 20241020125343.png]]

1. main.goにログイン、サインアップ、ログアウトのルートを追加します。

![[Pasted image 20241020125503.png]]

1. SessionsControllerにハンドラ関数を実装します：
    - サインアップ: メールアドレスの重複チェック、パスワードの確認、ユーザー作成
    - ログイン、ログアウト（次のビデオで実装予定）

![[Pasted image 20241020125614.png]]

![[Pasted image 20241020154714.png]]

![[Pasted image 20241020154414.png]]

![[Pasted image 20241020154817.png]]

1. ユーザーモデルに関連する関数を実装：
    - CheckAvailability: メールアドレスの重複チェック
    - Create: 新規ユーザー作成（パスワードをハッシュ化して保存）

![[Pasted image 20241020154842.png]]

1. HTMLテンプレートにアラート表示用の要素を追加します。

これらの手順により、基本的な認証システムの骨格が実装されました。次のビデオでは、ログインとログアウト機能を完成させる予定です。