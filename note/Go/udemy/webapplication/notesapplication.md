# create notes app
![[Pasted image 20241019181404.png]]

1. GOPATH/srcディレクトリに移動します。
2. プロジェクト用の新しいディレクトリを作成し、そのディレクトリに移動します。
3. 「gin-notes」という名前で新しいGoモジュールを初期化します。 正しいコマンドは「go mod init」です（「in mod」ではありません）。
4. 前回の「hello_gin」プロジェクトから、templatesとstaticフォルダをコピーします。これにより、再度作成する手間が省けます。
5. プロジェクトをVS Codeで開きます。
6. headerテンプレートを開き、プロジェクトのタイトルを変更します。 「Notes app」と名付けましょう。
7. 「hello_gin」プロジェクトからmain.goファイルもコピーし、タイトルを変更します。
8. プログラムを実行する前に、ターミナルを開きます。
9. 必要なパッケージをダウンロードし、サーバーを起動します。
10. ブラウザでURLにアクセスします。
11. プログラムが正常に動作することを確認します。



これらの手順により、新しい「Notes app」プロジェクトの基本的なセットアップが完了します。前回のプロジェクトからファイルを再利用することで、効率的に新しいプロジェクトを始めることができます。

# GORM integration

![[Pasted image 20241019183152.png]]

![[Pasted image 20241019183642.png]]

1. GORM（Go Object Relational Mapper）を深く学ぶ前に、データベースとユーザーを作成しましょう。
2. rootユーザーとしてMySQLコンソールを開きます。
3. アプリケーションがデータベースにアクセスするための新しいユーザーを作成します。
4. アプリケーション関連のすべてのテーブルを保持する新しいデータベースを作成します。
5. 作成したユーザーにデータベースへのアクセス権を付与します。
6. 必要なライブラリをインストールします：
    - まず、GORMライブラリをインストールします。
    - MySQLを使用してデータベーステーブルを保存するため、MySQLドライバーもインストールします。

![[Pasted image 20241019183949.png]]

![[Pasted image 20241019184110.png]]

1. コードに戻り、データベースに接続する関数を作成します：
    - 新しいMySQLコネクションを開きます。
    - 接続文字列を入力します（ユーザー名、パスワード、localhost、ポート3306、データベース名「notes」）。
    - UTF-8文字セットを使用します。
    - エラーがあればログを記録し、プログラムを停止します。
2. データベース接続を保存する変数を作成します。
3. プログラムの初期化時にconnectDatabase関数を呼び出します。
4. サーバーを起動します。
5. データベース接続に失敗した場合は、エラーを確認します。
    - この場合、パスワードが間違っていたようです。
6. パスワードを修正します。
7. サーバーを再起動します。

これらの手順により、データベースの設定とアプリケーションとの接続が行われます。パスワードの誤りのような小さな問題も、迅速に特定し修正することが重要です。

# GORM -First data model

1. モデルを作成するために、新しく「models」フォルダを作成します。
2. そのフォルダ内に「note.go」ファイルを作成します。
3. パッケージ名を「models」と定義します。
4. ノートの構造を定義します：
    - ID: プライマリーキー、uint64型、GORMパラメータで主キーと指定
    - Name: string型、GORMパラメータでサイズを指定
    - Content: string型、GORMパラメータでtext型として指定
    - CreatedAt, UpdatedAt: タイムスタンプ用、インデックスを追加
    - DeletedAt: ソフトデリート用、インデックスを追加
5. モデルの定義だけでは実際のテーブルは作成されません。テーブルを作成するには、マイグレーションを実行する必要があります。
6. main.goファイルに戻り、「dbMigrate」関数を作成します：
    - db.AutoMigrate(&models.Note{})を呼び出します
7. main関数内でdbMigrate関数を呼び出します。
8. サーバーを起動します。エラーが発生した場合は、括弧の欠落を修正します。
9. アプリケーションで使用している認証情報でMySQLコンソールを開きます。
10. データベースを選択し、テーブルを表示します。
11. マイグレーションによって「notes」テーブルが作成されたことを確認します。
12. テーブルの構造を確認します：
    - SHOW CREATE TABLE notes; コマンドを使用
13. テーブルがモデルで定義したとおりに作成されていることを確認します（全てのカラムとインデックスを含む）。

この手順により、GORMを使用してモデルを定義し、それに基づいてデータベーステーブルを自動的に作成する方法が示されています。これはコードファーストアプローチと呼ばれ、データベーススキーマの管理を容易にします。