ReactとGoを使っての開発へようこそ。
このコースでは、Reactのフロントエンドを使用してシングルページアプリケーションを構築する方法を学びます。
Reactはバージョン18、React Routerはバージョン6を使用し、そのフロントエンドの全データはGoで構築されたREST APIおよびGraphQLから供給されます。
この詳細については後ほど説明します。

このコースで学ぶことは何か？
Reactを網羅し、シングルページアプリケーションを構築するために必要なコンポーネント、ステート、フック、refsといった重要な事項をカバーします。

コースの最初のセクションでは、従来のクラスを用いた方法と、最新の関数型コンポーネントとフックを用いた方法の両方を使ってReactアプリケーションを構築する方法を学びます。

次に、Go（一般的に「Golang」と呼ばれる）でREST APIのバックエンドを構築し、Postgresデータベースの上に構築します。また、GraphQLの導入についても取り上げ、PostgresをバックエンドとしたグラフデータベースからフロントエンドでGraphQLを使用してクエリを実行します。GraphQLは近年ますます人気を集めています。

このアプリケーションでは、JOTS、JWT、JSON Webトークンを使ってユーザー認証を行います。また、リフレッシュトークンを導入し、ユーザーが再度ユーザー名やパスワードを入力しなくても自動的に再認証されるようにします。

では、なぜReactを使うのでしょうか？

まず、Reactは比較的学びやすいです。複雑ではなく、現在では基本的なJavaScriptです。クラスを除いてしまえば、JavaScriptとフックのみです。
Reactアプリケーションを作成する上で最も重要なことは、コンポーネントの動作を理解することです。
なぜなら、Reactにおいてすべてはコンポーネント、つまり再利用可能なコンポーネントだからです。
例えば、このコースではいくつかのフォームを作成しますが、手作業でフォームを作るのではなく、テキスト入力用のコンポーネントや、チェックボックス用のコンポーネント、セレクト用のコンポーネントなどを作成し、それらを必要なだけ再利用してフォームを構築していきます。

つまり、賢いコンポーネントを構築することで、フォームがより便利になり、構築も容易になります。

Reactは非常に高速で、アプリケーションを構築する際には常に良い点です。
理解に少し時間がかかる概念として、**単方向データフロー**がありますが、これはほとんどのシングルページアプリケーションで一般的です。また、Reactには大規模なユーザーコミュニティがあるため、リソースやサポートを見つけるのが比較的簡単です。

次に、なぜGoを選ぶのかについて説明します。

Goは近年非常に人気が高まっており、バックエンドアプリケーションを構築するための非常に人気のある言語です。
このコースで行う内容そのものです。
Goは非常に学びやすく理解しやすい言語であり、特に並行処理のサポートが標準で組み込まれている点が、他のほとんどの言語より優れています。
唯一、Rustが同等またはそれに近いと言えるでしょう。

Goは型安全な言語であり、例えば整数型の変数を宣言すると、その変数には整数のみを格納できます。JavaScriptやPHPのような言語から移行してきた人にとっては新しいかもしれませんが、コードをバグが少なくなるようにします。

最後に、Goは単一のバイナリにコンパイルされます。
つまり、アプリケーションの構築が完了した後、バックエンドアプリケーションは1つのファイルをサーバーにコピーして起動するだけで動作します。
それが私たちのバックエンドAPIになります。

このコースでは何を構築するのでしょうか？
シングルページアプリケーションを構築し、ユーザー認証、レコードの追加、更新、削除といった標準的な機能を備えたものを作成します。
バックエンドはGoで書かれ、JSONとGraphQLの両方を扱い、フロントエンドはReactで構築されます。
最後に、JSON Webトークン（JOTS）を使ってサイトを保護します。

では、具体的にどんなアプリケーションを作るのか見ていきましょう。
このコースの第2セクションで構築するアプリケーションがこちらです。
最初のセクションはReactの基本的な練習です。

見た目の面ではあまり魅力的ではないかもしれませんが、このコースはグラフィックデザインのコースではなく、Reactでアプリケーションを構築し、Goでバックエンドを構築する方法を学ぶコースです。

アプリケーションでは映画をブラウズして、今夜見る映画を探せます。
映画のリストが表示され、少数しか選択肢はありませんが、コースの目的には十分です。
例えば、「ゴッドファーザー」をクリックすると、映画の写真、説明、関連情報が表示されます。
非常にシンプルです。

また、ジャンル別に映画をブラウズすることもできます。
例えば、冒険映画だけを見たいときには、恐らく1本しかありませんね。
「レイダース/失われたアーク《聖櫃》」です。

とてもシンプルですが、ログインもできます。

こちらで「 admin@example.com 」というユーザー名と適切なパスワードでログインしてみます。
現在、画面上部には「ログイン」と表示されており、メニュー項目は3つだけです。
ログインすると、バックエンドに接続し、JSON Webトークンとリフレッシュトークンが返されます。

ログイン後は、機能が増えます。
映画を閲覧するだけでなく、新しい映画を追加できるようになります。
ここで必要な情報をすべて入力し、追加する映画が該当するジャンルをチェックして保存します。
これにより、新しい映画がデータベースに登録されます。

カタログの管理もでき、個々の映画を見て自由に変更を加え、再度保存することも可能です。

最後に、同じデータベースを閲覧する方法として、今回はGraphQLを使用したグラフデータベースも扱います。
GraphQLはフロントエンドのデザイナーに非常に好まれており、必要な情報を得るためにバックエンドをプログラマーに変更してもらう必要がなくなります。

GraphQLの使い方の基本も学びます。
例えば、こちらの映画リストと先ほどのリストの違いは、名前でフィルターできる点です。
例えば、「the」と入力すると、タイトルに「the」を含む映画だけが表示されます。

とても楽しみですね。それでは始めましょう。
# Getting Started with React
## How React Works
では、初めてのReactアプリケーションを作成しましょう。

まず、お気に入りのターミナルを開きます。
ここでは、ターミナルを開いてデスクトップに移動します。
私はMacを使用しているので、デスクトップに移動しますが、作業場所は自由に選んでください。

デスクトップフォルダに移動し、新しいディレクトリを作成します。
ディレクトリ名は`React-apps`とします。
作成したディレクトリに移動し、その中が空であることを確認します。

Reactアプリケーションを作成するにはどうすればいいでしょうか？
幸いにも、Nodeがインストールされていれば非常に簡単です。
次のコマンドを入力します：

```bash
npx create-react-app my-app
```

ここで、`npx`は正しいコマンドです。
これはスペースを空けて入力し、その後に`create-react-app`と、最後にアプリケーションの名前を指定します。
今回は`my-app`とします。

リターンキーを押すと、過去に`create-react-app`のバージョンがインストールされている場合、メッセージが表示されることがあります。
React 18を使用しているため、古いバージョンでは使用できない旨の通知が来るかもしれません。
その際は、以下のコマンドでアンインストールしてください：

```bash
npm uninstall -g create-react-app
```

アンインストールが完了したら、再度以下のコマンドを入力します：

```bash
npx create-react-app my-app
```

この時、`create-react-app`のインストールを確認されることがありますが、Enterを押せばインストールが始まります。

初めてこのコマンドを実行する場合、インストールには数分かかることがありますが、次回以降はかなり速くなります。
インストールが完了するまで待つと、使い方の指示が表示されます。

インストールが完了すると、作成されたディレクトリ（今回は`my-app`という名前で指定したもの）の中で使用できるコマンドが表示されます。
たとえば、`npm start`を実行すると開発サーバーが起動します。
これをすぐに試してみましょう。
それ以外のコマンドについては後で説明します。

では、Visual Studio Codeを開きます。
VS Codeを起動し、新しいウィンドウを作成します。
ファイルブラウザをクリックし、「Open Folder」を選択してデスクトップ上のReactアプリケーションフォルダを見つけます。
先ほど作成した`my-app`フォルダをダブルクリックして開きます。

フォルダの中身を見ていきましょう。
`node_modules`フォルダがありますが、これは編集対象ではないためグレーアウトされています。
これはNodeによってインストールされたパッケージで、Reactが使用します。
中には多くのファイルが含まれていますが、今は無視して構いません。
Nodeがすべて処理してくれます。

次に`public`フォルダがあります。
これを開いてみましょう。
その中には`favicon`が含まれています。
WebアプリケーションやWebページを扱ったことがあるなら、このアイコンが何か知っているでしょう。

それは、Firefoxや他のウェブブラウザのタブに表示される小さなバッジです。
そして、`index.html`も含まれています。

その`index.html`を見てみましょう。
標準的なHTML5の形式で、言語タイプが宣言されています。
`head`セクションには標準的な要素が並んでおり、多くのコメントも含まれています。
その中には、通常のHTMLと異なる点に注目させるコメントもあります。

例えば、5行目の`favicon`へのリンクでは、`href`属性が`%PUBLIC_URL%`となっています。
下の`Apple Touch icon`や`manifest`でも同様の構造になっており、コメントでもそのことが説明されています。

コメントには、「`%`記号で囲まれた`PUBLIC_URL`は、ビルドフェーズ中に`public`フォルダのURLに置き換えられます」とあります。
これは開発フェーズではなく、アプリケーションが完成して本番環境に移す際のビルドフェーズで重要になります。

わかりやすくするために、これらのコメントを削除してHTML本体だけを見てみましょう。
コメントを削除すると、実際のHTMLはあまり多くはありません。
`head`タグの内容を除くと、`<noscript>`タグがあり、「このアプリケーションを使用するにはJavaScriptが必要です」と表示されています。

そして、空の`<div>`要素が1つあり、`id`は`root`です。
この`<div>`は何も含んでいません。

次に、統合ターミナルを開きましょう。

![[Pasted image 20241109223259.png]]

Visual Studio Codeの一部である統合ターミナルを開くと、現在のフォルダ（`my-app`）内のコマンドプロンプトが表示されます。
ここで、`npx create-react-app`によって指示された`npm start`コマンドを実行し、アプリケーションを起動します。
このコマンドにより、Webブラウザが開き、実行中のアプリケーションが表示されます。

表示されたページには、回転するロゴと、「やるべきこと」の簡単な説明、Reactを学ぶためのリンクが見えます。
次に、このページのソースコードを確認してみます。
標準的な「ソースの表示」コマンドを使用してソースを見ると、内容は非常にシンプルであることがわかります。
`<body>`タグには`<noscript>`タグと、空の`id="root"`を持つ`<div>`タグしかありません。
回転するロゴやテキストなどは存在していません。

この状態を閉じて、ソースの代わりにページを「検証」してみましょう。
ページ上で右クリックし、「検証」を選択します。
すると、画面上で実際に見えている内容が表示されます。
`<div id="root">`はもう空ではなく、内部に`class="App"`を持つ`<div>`と`<header>`が含まれています。
その中に画像、段落テキスト、リンクがあります。

これらの要素はどこから来ているのでしょうか？
IDEに戻り、Visual Studio Codeで確認してみましょう。
ターミナルは非表示にしますが、アプリケーションは引き続き実行しておきます。

次に重要なフォルダへ移動します。
`public`フォルダの残りの内容は今は無視しますが、大きな驚きはありません。

`public`フォルダ内には、いくつかの画像、`manifest`ファイル、`robots.txt`ファイルがあり、これらはWebアプリケーションやWebページでは一般的です。

次に`src`フォルダを見てみましょう。
まずは`index.js`ファイルを見てみます。
通常、`index`という名前が付いているファイルがスタートポイントですので、ここから始めましょう。

このファイルは標準的なJavaScriptコードで、JavaScriptアプリケーションを扱ったことがあれば驚くことはほとんどないでしょう。
1行目から始まる`import`文で、`react`を`React`としてインポートしています。
これはReactフレームワークを構成するJavaScriptパッケージの1つで、`node_modules`から取得しています。

次に、`react-dom/client`から`reactDom`をインポートしています。
これは、Reactプロジェクトを構築・保守しやすくするために、複数のパッケージに分割された一部です。

さらに、`./index.css`をインポートしています。
これにより、`index.css`というカスケーディングスタイルシート（CSS）がプロジェクトに取り込まれます。
このCSSは、`body`のフォントを変更し、コードタイプに特定のフォーマットを適用する役割を持っています。

もしこの`import`文をコメントアウトして削除したらどうなるでしょうか？
CSSのインポートを削除しても、アプリケーションは特に問題なく動作し続けます。

エラーメッセージは出ませんが、ターミナルを開いたままにしておけば、再コンパイルされたことがわかります。
ここにそのメッセージがあります。

Webブラウザに戻ってみると、開発ツールを閉じた状態で、フォントが変わっていることがわかります。
ブラウザのデフォルトフォントに戻り、`body`の見た目も少し変わっています。

では、IDEに戻り、コメントアウトした`import`文を元に戻して保存します。
すると、再コンパイルが非常に迅速に行われます。
ブラウザに戻ると、すべてが元通りになり、見た目も良くなります。
`body`全体の境界線がなくなり、フォントも再び適用されました。
開発中、このCSSは非常に役に立つでしょう。

`index.js`ファイルに戻ると、`import`文には特に驚く点はありません。
7行目には`root`という定数があり、`ReactDOM`（2行目でインポートしたもの）から`createRoot`を使ってアプリケーションのルートを作成しています。
特定の場所、つまり`document.getElementById("root")`に基づいて作成されます。
この`root`が何かはすでにわかっているでしょう。
それは`index.html`内の`id="root"`を持つ`<div>`を指しています。
この`<div>`内にWebアプリケーション全体が存在します。

次に、`root.render`がこのファイルで重要な最後の部分です。
`reportWebVitals`については気にしなくても構いません。

実際、この`reportWebVitals`はそのうち削除する予定ですが、今はそのままにしておきます。

`root.render`の中には、開きと閉じの括弧があり、その中に`<React.StrictMode>`タグが開閉し、その間に`<App />`タグがあります。

この`App`とは何でしょうか？
インポートの行を見上げると、`import App from './App';`と記述されています。
そこで`./App`を探すと、`App.js`が見つかります。
これを開くと、Reactの最初のコンポーネントを目にすることになります。
以前の講義で述べたように、Reactではすべてがコンポーネントとして構成されています。
この`App`はその一例です。

`App.js`には2つのインポートがあります。
最初のものはSVG（スケーラブル・ベクター・グラフィック）ファイルをインポートしており、Reactアプリケーションに画像を組み込んでいます。
これは少し奇妙に思えるかもしれませんが、Reactではこのように動作します。
もう1つはCSSファイルをインポートしており、これは標準的なスタイルシートです。

注目すべきは、この関数型コンポーネントです。
React 16以前は、コンポーネントはクラスを使用して作成するのが一般的でしたが、React 16以降、関数型コンポーネントとフックを使う方法が主流になっています。
現在でもクラスを使ったコンポーネントは多くのコードで見られるため、その方法を知っておくことも重要です。

この`App`コンポーネントはフックを含んでいませんが、関数型コンポーネントです。
`App`という名前のシンプルなJavaScript関数があり、25行目で`export default App;`とエクスポートされています。
このエクスポート文によって、`index.js`で`App`としてインポートできるようになります。

`App`関数はHTMLに似たものを返しますが、厳密にはHTMLではなく、JSX（JavaScript XML）と呼ばれるものです。
HTMLに非常に似ていますが、いくつかの違いがあります。

その違いの一つは、6行目の`<div>`タグです。
`class="app"`ではなく、`className="app"`と記述されています。
これは、`class`がJavaScriptでは予約語であり、オブジェクト指向プログラミングの一部だからです。
Reactでは代わりに`className`を使用します。

もう一つの違いは、8行目の`<img>`タグです。
`src`属性には画像のフルパスを記述する代わりに、`{logo}`という単一の中括弧で囲んだ変数が使われています。

この`logo`はJavaScriptの式で、1行目の`import logo`から参照されています。
このインポートによって画像ファイルの適切なパスが取得され、アプリケーションがビルドされてレンダリングされる際に、そのパスがHTML（正確にはJSX）としてブラウザに送信されます。

ブラウザに戻ると、「Edit `src/App.js` and save to reload.」という行があります。
これを変更してみましょう。
「Edit」を「You can edit」に変更し、保存します。
なお、私はVisual Studio Codeの「AutoSave」オプションを有効にしているので、毎回保存する手間が省けます。
これを設定しておくと便利です。

ブラウザに戻ると、すぐに「You can edit `src/App.js` and save to reload.」に変更されていることが確認できます。

他にも多くのファイルがありますが、それぞれを個別に説明するのは避け、もう少し難しいが有用なアプローチを取ります。
次の講義では、これらのファイルのほとんどを削除し、`index.js`の内容をすべて消して、シンプルな「Hello, World」アプリケーションをゼロから構築します。

では、次に進みましょう。

## Hello world with React using Classes
現在、私たちのReactアプリケーションは機能していますが、`npx create-react-app`コマンドで作成したデフォルトアプリケーションとほぼ同じです。
ここまでの作業で、少しコードを変更しただけです。
では、このアプリケーションを少し変えてみましょう。

まず、IDEに戻り、開いているファイルをすべて閉じます。
アプリケーションを実行したままにしておきますが、これからいくつかエラーが発生するのをターミナルで確認できます。
ここから少し複雑にしていきます。

まず、`src`フォルダ内のいくつかのファイルを削除します。
`App.js`、`App.css`、`App.test.js`、`index.css`を削除し、`index.js`だけは残しておきます。
これらをゴミ箱に移動し、削除します。すると、コンパイルエラーが発生しますが、エラーメッセージは「モジュールが見つからない、`App.js`を解決できない」というものです。
これは、`index.js`で存在しないファイルをインポートしているからです。

そのため、インポート文のうち、`react`と`react-dom`以外の不要なインポートを削除します。さらに、コメント行や`reportWebVitals`の行も削除します。まだエラーは残りますが、それは`App`というものを参照しているためです。`App`は存在せず、インポートもしていないためです。

そこで、新しいファイルを`src`フォルダに作成し、`AppClass.js`という名前を付けます。このファイルで新しいコンポーネントを作成しますが、今回は関数型コンポーネントではなく、クラスコンポーネントを使用します。これはReact 16以前の方法です。

コンポーネントを作成するため、次のように入力します：

```javascript
import React, { Component } from 'react';
```

このインポート文は、`React`と`Component`を`react`から取り込むことを示しています。

インポートは完了しましたが、エラーが残っています。
`App`ファイルがまだないため、エラーが続いています。
これについては一旦閉じて、クラスコンポーネントの作成に集中しましょう。

初めてのReactクラスコンポーネントを作成します。
次のコードを入力します：

```javascript
export default class AppClass extends Component {
    render() {
        return (
            <div>
                Hello, World!
            </div>
        );
    }
}
```

ここで`export default`を使用し、`class`というキーワードでクラスを定義しています。
このクラスの名前は`AppClass`で、`Component`を拡張（`extends`）しています。
`Component`はReactに組み込まれているクラスです。

クラスコンポーネントでは必ず`render`関数が必要です。
この関数はJSXを返すもので、今回は単純に「Hello, World!」を返す構造にしています。
`render`関数内のJSXは`<div>`にラップして返されています。

これで基本的なクラスコンポーネントが完成です。

新しいプログラミング言語やプラットフォームを紹介する際に「Hello, World」アプリケーションを作らなかったら、何か悪いことが起こるような気がします。
おそらく教える資格が取り消されるかもしれませんね。
でも、ここではしっかり「Hello, World」アプリケーションを作成しました。

`render`メソッドの後には、必要はないかもしれませんが、私は通常セミコロンを付けるようにしています。
これで`AppClass.js`は完成しました。

ターミナルを開くと、まだエラーが発生しているかもしれません。それは、`App`が定義されていないからです。`index.js`に戻って、次のようにインポート文を追加します：

```javascript
import AppClass from './AppClass';
```

これで、`AppClass`がインポートされました。次に、`index.js`内の`<App />`を`<AppClass />`に変更します。

```javascript
root.render(
    <React.StrictMode>
        <AppClass />
    </React.StrictMode>
);
```

これを保存すると、ターミナルでコンパイルが成功したメッセージが表示されるはずです。
Webブラウザに戻ると、画面には「Hello, World」と表示されています。

特に目新しさはないかもしれませんが、ご覧のとおり、使わないコードを削除してコードを整理しました。
`index.js`を修正して、唯一のコンポーネントである`AppClass`をインポートし、`root.render`内の名前を`<AppClass />`に変更しました。

`AppClass`の定義は`./AppClass`にあり、これは`src`フォルダ内のこのファイルです。
このクラスコンポーネントは非常にシンプルで、`<h1>`タグに囲まれた「Hello, World」を返します。
これがクラスコンポーネントを作成する方法です。

次の講義では、同じことを関数型コンポーネントを使って実現します。それでは、次に進みましょう。

## Hello 